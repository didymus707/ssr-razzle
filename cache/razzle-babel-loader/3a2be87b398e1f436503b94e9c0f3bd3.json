{"ast":null,"code":"import { createEntityAdapter, createSelector, createSlice } from '@reduxjs/toolkit';\nimport { selectOrganisationID } from '../../../unauthenticated-app/authentication';\nimport { connectChannelAcct, fetchSupportedChannels, setChannelName } from '../../channels/channel.thunks';\nimport { INBOX_INIT } from '../inbox.data';\nimport { selectCustomerEntities } from './customer';\nimport { fetchThreadMessages, fetchThreadsByState, onWebSocketAssignedThread, onWebSocketNewMessage, onWebSocketNewThread, onWebSocketResolvedThread, onWebSocketWhatsAppAccountStatusChange, fetchThreadByID, sendMessage, searchInbox } from './global';\nconst platformContactsAdapter = createEntityAdapter({\n  selectId: platformContact => platformContact.uuid\n});\n\nconst platformContactsUpsertCallback = (state, action) => {\n  const {\n    platformContacts\n  } = action.payload;\n  platformContacts && platformContactsAdapter.upsertMany(state, platformContacts);\n};\n\nexport const platformContactsSlice = createSlice({\n  name: \"platformContacts\",\n  initialState: platformContactsAdapter.getInitialState(),\n  reducers: {},\n\n  extraReducers(builder) {\n    builder.addCase(fetchThreadsByState.fulfilled, platformContactsUpsertCallback).addCase(fetchThreadMessages.fulfilled, platformContactsUpsertCallback).addCase(searchInbox.fulfilled, platformContactsUpsertCallback).addCase(sendMessage.fulfilled, platformContactsUpsertCallback).addCase(onWebSocketNewThread, platformContactsUpsertCallback).addCase(onWebSocketResolvedThread, platformContactsUpsertCallback).addCase(onWebSocketAssignedThread, platformContactsUpsertCallback).addCase(onWebSocketNewMessage, platformContactsUpsertCallback).addCase(fetchSupportedChannels.fulfilled, platformContactsUpsertCallback).addCase(connectChannelAcct.fulfilled, platformContactsUpsertCallback).addCase(setChannelName.fulfilled, platformContactsUpsertCallback).addCase(fetchThreadByID.fulfilled, platformContactsUpsertCallback).addCase(onWebSocketWhatsAppAccountStatusChange, platformContactsUpsertCallback);\n  }\n\n});\nexport const platformContactsReducer = platformContactsSlice.reducer;\nexport const {\n  selectById: selectPlatformContactById,\n  selectIds: selectPlatformContactIds,\n  selectEntities: selectPlatformContactEntities,\n  selectAll: selectAllPlatformContacts,\n  selectTotal: selectTotalPlatformContacts\n} = platformContactsAdapter.getSelectors(state => state.inbox.entities.platformContacts);\nexport const selectPlatformContact = createSelector((_, payload) => payload.id, (_, payload) => payload.credentialUserID, selectOrganisationID, selectAllPlatformContacts, selectCustomerEntities, (cusID, credentialUserID, orgID, platformContacts, customersObj) => {\n  const platformContact = platformContacts.find(({\n    organisation_id,\n    customer_id,\n    receiver_platform_id\n  }) => {\n    var _customersObj$credent;\n\n    return orgID === organisation_id && customer_id === cusID && (!receiver_platform_id || !credentialUserID || ((_customersObj$credent = customersObj[credentialUserID]) === null || _customersObj$credent === void 0 ? void 0 : _customersObj$credent.platform_nick) === receiver_platform_id);\n  }) || INBOX_INIT.platformContact;\n  return platformContact;\n});\nexport const selectPlatformContactName = createSelector(selectPlatformContact, p => p.name);","map":{"version":3,"sources":["/Users/okechukwuiheagwara/Documents/Adewale/simpu/razzle/with-typescript/src/app/authenticated-app/inbox/slices/platformContact.ts"],"names":["createEntityAdapter","createSelector","createSlice","selectOrganisationID","connectChannelAcct","fetchSupportedChannels","setChannelName","INBOX_INIT","selectCustomerEntities","fetchThreadMessages","fetchThreadsByState","onWebSocketAssignedThread","onWebSocketNewMessage","onWebSocketNewThread","onWebSocketResolvedThread","onWebSocketWhatsAppAccountStatusChange","fetchThreadByID","sendMessage","searchInbox","platformContactsAdapter","selectId","platformContact","uuid","platformContactsUpsertCallback","state","action","platformContacts","payload","upsertMany","platformContactsSlice","name","initialState","getInitialState","reducers","extraReducers","builder","addCase","fulfilled","platformContactsReducer","reducer","selectById","selectPlatformContactById","selectIds","selectPlatformContactIds","selectEntities","selectPlatformContactEntities","selectAll","selectAllPlatformContacts","selectTotal","selectTotalPlatformContacts","getSelectors","inbox","entities","selectPlatformContact","_","id","credentialUserID","cusID","orgID","customersObj","find","organisation_id","customer_id","receiver_platform_id","platform_nick","selectPlatformContactName","p"],"mappings":"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","sourcesContent":["import {\n  createEntityAdapter, createSelector, createSlice\n} from '@reduxjs/toolkit'\nimport { RootState } from '../../../../root'\nimport { selectOrganisationID } from '../../../unauthenticated-app/authentication';\nimport { connectChannelAcct, fetchSupportedChannels, setChannelName } from '../../channels/channel.thunks';\nimport { INBOX_INIT } from '../inbox.data';\nimport { PlatformContactSchema } from '../inbox.types';\nimport { selectCustomerEntities } from './customer';\nimport {\nfetchThreadMessages, fetchThreadsByState, onWebSocketAssignedThread,\nonWebSocketNewMessage, onWebSocketNewThread, onWebSocketResolvedThread,\nonWebSocketWhatsAppAccountStatusChange, fetchThreadByID, sendMessage, searchInbox\n} from './global';\n\nconst platformContactsAdapter = createEntityAdapter<PlatformContactSchema>({\nselectId: platformContact => platformContact.uuid,\n});\n\nconst platformContactsUpsertCallback = (state: any, action: any) => {\nconst { platformContacts } = action.payload;\nplatformContacts && platformContactsAdapter.upsertMany(state, platformContacts);\n};\n\nexport const platformContactsSlice = createSlice({\nname: \"platformContacts\",\ninitialState: platformContactsAdapter.getInitialState(),\nreducers: {},\nextraReducers(builder) {\n  builder\n    .addCase(fetchThreadsByState.fulfilled, platformContactsUpsertCallback)\n    .addCase(fetchThreadMessages.fulfilled, platformContactsUpsertCallback)\n    .addCase(searchInbox.fulfilled, platformContactsUpsertCallback)\n    .addCase(sendMessage.fulfilled, platformContactsUpsertCallback)\n    .addCase(onWebSocketNewThread, platformContactsUpsertCallback)\n    .addCase(onWebSocketResolvedThread, platformContactsUpsertCallback)\n    .addCase(onWebSocketAssignedThread, platformContactsUpsertCallback)\n    .addCase(onWebSocketNewMessage, platformContactsUpsertCallback)\n    .addCase(fetchSupportedChannels.fulfilled, platformContactsUpsertCallback)\n    .addCase(connectChannelAcct.fulfilled, platformContactsUpsertCallback)\n    .addCase(setChannelName.fulfilled, platformContactsUpsertCallback)\n    .addCase(fetchThreadByID.fulfilled, platformContactsUpsertCallback)\n    .addCase(onWebSocketWhatsAppAccountStatusChange, platformContactsUpsertCallback);\n},\n});\n\nexport const platformContactsReducer = platformContactsSlice.reducer;\n\nexport const {\nselectById: selectPlatformContactById,\nselectIds: selectPlatformContactIds,\nselectEntities: selectPlatformContactEntities,\nselectAll: selectAllPlatformContacts,\nselectTotal: selectTotalPlatformContacts,\n} = platformContactsAdapter.getSelectors<RootState>((state) => state.inbox.entities.platformContacts);\n\nexport const selectPlatformContact = createSelector(\n  (_: RootState, payload: { id: string }) => payload.id,\n  (_: RootState, payload: { credentialUserID?: string }) => payload.credentialUserID,\n  selectOrganisationID,\n  selectAllPlatformContacts,\n  selectCustomerEntities,\n  (cusID, credentialUserID, orgID, platformContacts, customersObj) => {\n    const platformContact = platformContacts.find(\n      ({ organisation_id, customer_id, receiver_platform_id }) => (\n        orgID === organisation_id && customer_id === cusID && (\n          !receiver_platform_id || !credentialUserID || customersObj[credentialUserID]?.platform_nick === receiver_platform_id\n        )\n      )\n    ) || INBOX_INIT.platformContact;\n\n    return platformContact;\n  }\n)\n\nexport const selectPlatformContactName = createSelector(\n  selectPlatformContact,\n  p => p.name\n);\n"]},"metadata":{},"sourceType":"module"}