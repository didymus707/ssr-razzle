{"ast":null,"code":"const _excluded = [\"file\"];\nvar _jsxFileName = \"/Users/okechukwuiheagwara/Documents/Adewale/simpu/razzle/with-typescript/src/app/authenticated-app/index.tsx\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport { useToast } from '@chakra-ui/core';\nimport { fromUnixTime, isAfter } from 'date-fns';\nimport jwt_decode from 'jwt-decode';\nimport { isEmpty } from 'lodash';\nimport * as React from 'react';\nimport { useQuery } from 'react-query';\nimport { connect, useSelector } from 'react-redux';\nimport { Redirect, Route, Switch } from 'react-router-dom';\nimport { loadState, toFormData } from '../../utils';\nimport { initializePusher } from '../../utils/pusher';\nimport { ErrorBoundary, ErrorPage, PreloadedStateProvider, ProtectedRoute, SimpuDashboard, ToastBox } from '../components';\nimport { NoSubscriptionDialog } from '../components/NoSubscriptionDialog';\nimport { authLoading, fetchProfile, logout, logUserOut } from '../unauthenticated-app/authentication';\nimport { getUserChannels } from './channels';\nimport { openNoSubscriptionModal } from './globals';\nimport { Home } from './home';\nimport { InboxComponent, selectOrgInboxStatusCount, stopPopSound, subscribeToWebsocket } from './inbox';\nimport { InboxProvider } from './inbox/components/Provider';\nimport { useReactQuerySubscription } from './inbox/inbox.hooks';\nimport { InboxSettings } from './inbox/settings';\nimport { Integrations } from './integrations';\nimport { generateRandomListColor, generateRandomListIcon, Lists, ListView } from './lists';\nimport { MarketingUI } from './marketing';\nimport { CampaignAnalytics, CreateCampaign, filterCampaigns, ViewCampaign } from './marketing/campaigns';\nimport { CreateCoupon, ViewCoupon } from './marketing/coupons/components';\nimport { Onboarding } from './onboarding';\nimport { Payments, PaymentsOnboarding } from './payments'; // @ts-ignore\n\nimport popSound from './pop_sound.mp3';\nimport { SettingsContainer } from './settings';\nimport { DevelopersHomeUi } from './settings/component/developers';\nimport { addTable, addTableFromTemplate, importRowsCSV, importRowsMapping } from './tables';\nconst connector = connect(state => ({\n  user: state.auth.user,\n  token: state.auth.token,\n  organizations: state.teams.organizations,\n  state,\n  tables: state.tables.tables,\n  profile: state.auth.profile,\n  importedData: state.tables.importedData,\n  createTableModalIsOpen: state.globals.createTableModalIsOpen,\n  noSubscriptionModalIsOpen: state.globals.noSubscriptionModalIsOpen,\n  shouldPopSound: state.inbox.inboxUi.shouldPopSound,\n  websocketSubscribedOrgs: state.inbox.inboxUi.websocketSubscribedOrgs\n}), {\n  authLoading,\n  fetchProfile,\n  addTable,\n  logUserOut,\n  importRowsCSV,\n  importRowsMapping,\n  addTableFromTemplate,\n  openNoSubscriptionModal,\n  stopPopSound,\n  subscribeToWebsocket\n});\n\nfunction App(props) {\n  var _campaigns$data;\n\n  const {\n    user,\n    tables,\n    history,\n    profile,\n    token,\n    organizations,\n    addTable,\n    logUserOut,\n    importedData,\n    importRowsCSV,\n    importRowsMapping,\n    addTableFromTemplate,\n    shouldPopSound,\n    stopPopSound,\n    subscribeToWebsocket,\n    websocketSubscribedOrgs,\n    authLoading,\n    fetchProfile\n  } = props;\n  const {\n    data: campaigns\n  } = useQuery('campaigns', () => filterCampaigns({\n    page: 1,\n    query: undefined\n  }));\n  const {\n    data: channels\n  } = useQuery('channels', getUserChannels);\n  const onboarding_task_info = {\n    channels: !!(channels !== null && channels !== void 0 && channels.length),\n    teams: !!props.state.teams.teams.length,\n    lists: !!props.state.lists.lists_by_id.length,\n    campaigns: !!(campaigns !== null && campaigns !== void 0 && (_campaigns$data = campaigns.data) !== null && _campaigns$data !== void 0 && _campaigns$data.campaigns.length)\n  };\n\n  const isLoggedIn = () => {\n    if (token && !isEmpty(user)) {\n      const decoded = jwt_decode(token);\n\n      if (decoded && decoded.exp && isAfter(fromUnixTime(decoded.exp), new Date())) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  const toast = useToast();\n  const audioRef = React.useRef(null);\n  const unReadThreadCount = useSelector(state => selectOrgInboxStatusCount(state, {\n    organisation_id: profile === null || profile === void 0 ? void 0 : profile.organisation_id,\n    user_id: user === null || user === void 0 ? void 0 : user.id\n  }));\n  React.useEffect(() => {\n    initializePusher(user === null || user === void 0 ? void 0 : user.id); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  React.useEffect(() => {\n    organizations.forEach(({\n      id\n    }) => {\n      if (id && profile !== null && profile !== void 0 && profile.id && !websocketSubscribedOrgs[id]) {\n        subscribeToWebsocket({\n          organisation_id: id,\n          profile_id: profile === null || profile === void 0 ? void 0 : profile.id\n        });\n      }\n    }); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [organizations, profile === null || profile === void 0 ? void 0 : profile.id, websocketSubscribedOrgs]);\n  React.useEffect(() => {\n    document.title = unReadThreadCount > 0 ? `(${unReadThreadCount}) Simpu` : 'Simpu'; // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [unReadThreadCount]);\n  React.useEffect(() => {\n    try {\n      if (audioRef && audioRef.current && shouldPopSound) {\n        audioRef.current.play();\n        stopPopSound();\n      }\n    } catch (error) {} // eslint-disable-next-line react-hooks/exhaustive-deps\n\n  }, [shouldPopSound]);\n  useReactQuerySubscription();\n\n  async function handleLogout() {\n    await logout(user === null || user === void 0 ? void 0 : user.id);\n    logUserOut();\n    history.push('/login');\n  }\n\n  async function handleImport(payload) {\n    let {\n      file\n    } = payload,\n        rest = _objectWithoutProperties(payload, _excluded);\n\n    try {\n      await importRowsCSV(toFormData(rest, file, 'file'));\n      toast({\n        position: 'bottom-left',\n        render: () => __jsx(ToastBox, {\n          status: \"success\",\n          message: \"File upload successful\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 200,\n            columnNumber: 23\n          }\n        })\n      });\n    } catch (error) {\n      toast({\n        position: 'bottom-left',\n        render: () => __jsx(ToastBox, {\n          message: error,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 205,\n            columnNumber: 23\n          }\n        })\n      });\n    }\n  }\n\n  async function handleImportMapping(payload) {\n    try {\n      await importRowsMapping(payload);\n    } catch (error) {\n      toast({\n        position: 'bottom-left',\n        render: ({\n          onClose\n        }) => __jsx(ToastBox, {\n          onClose: onClose,\n          message: error,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 216,\n            columnNumber: 34\n          }\n        })\n      });\n    }\n  }\n\n  async function handleImportNewTable(properties) {\n    let mapping = {};\n    const {\n      table\n    } = await addTable({\n      user_id: user === null || user === void 0 ? void 0 : user.id,\n      columns: properties,\n      name: 'Untitled',\n      color: generateRandomListColor(),\n      icon: generateRandomListIcon()\n    });\n    table.columns.forEach(({\n      id\n    }) => {\n      if (id) {\n        mapping[id] = id;\n      }\n    });\n    await handleImportMapping({\n      mapping,\n      table_id: table.id,\n      id: importedData.id\n    });\n    return table;\n  }\n\n  async function reloadOrganization(org_id) {\n    if (!!loadState()) {\n      authLoading(true);\n\n      try {\n        await fetchProfile(org_id);\n      } catch (e) {}\n\n      window.location.reload();\n    }\n  }\n\n  return __jsx(PreloadedStateProvider, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 254,\n      columnNumber: 5\n    }\n  }, __jsx(SimpuDashboard, {\n    onboarding_task_info: onboarding_task_info,\n    tables: tables,\n    organizations: organizations,\n    profile: profile,\n    user: user,\n    onLogout: handleLogout,\n    unReadThreadCount: unReadThreadCount,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 255,\n      columnNumber: 7\n    }\n  }, __jsx(\"audio\", {\n    controls: true,\n    ref: audioRef,\n    style: {\n      display: 'none'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 264,\n      columnNumber: 9\n    }\n  }, __jsx(\"source\", {\n    src: popSound,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 265,\n      columnNumber: 11\n    }\n  }), \"Your browser does not support the audio element.\"), __jsx(ErrorBoundary, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 268,\n      columnNumber: 9\n    }\n  }, __jsx(Switch, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 269,\n      columnNumber: 11\n    }\n  }, __jsx(ProtectedRoute, {\n    path: \"/s/home\",\n    isLoggedIn: isLoggedIn(),\n    render: props => __jsx(Home, _extends({}, props, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 273,\n        columnNumber: 32\n      }\n    })),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 270,\n      columnNumber: 13\n    }\n  }), __jsx(ProtectedRoute, {\n    path: \"/s/onboarding\",\n    isLoggedIn: isLoggedIn(),\n    render: props => __jsx(Onboarding, _extends({}, _objectSpread({\n      user,\n      profile\n    }, props), {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 278,\n        columnNumber: 32\n      }\n    })),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 275,\n      columnNumber: 13\n    }\n  }), __jsx(ProtectedRoute, {\n    exact: true,\n    path: \"/s/lists/view/:id/smart\",\n    isLoggedIn: isLoggedIn(),\n    render: props => __jsx(ListView, _extends({}, _objectSpread(_objectSpread({}, props), {}, {\n      is_smart_list: true\n    }), {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 284,\n        columnNumber: 32\n      }\n    })),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 280,\n      columnNumber: 13\n    }\n  }), __jsx(ProtectedRoute, {\n    exact: true,\n    path: \"/s/lists/view/:id\",\n    isLoggedIn: isLoggedIn(),\n    render: props => __jsx(ListView, _extends({}, _objectSpread(_objectSpread({}, props), {}, {\n      is_smart_list: false\n    }), {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 290,\n        columnNumber: 32\n      }\n    })),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 286,\n      columnNumber: 13\n    }\n  }), __jsx(ProtectedRoute, {\n    path: \"/s/lists\",\n    isLoggedIn: isLoggedIn(),\n    render: props => __jsx(Lists, _extends({}, _objectSpread(_objectSpread({}, props), {}, {\n      addList: addTable,\n      addListFromTemplate: addTableFromTemplate,\n      handleImport,\n      handleImportMapping,\n      handleImportNewTable,\n      importedData\n    }), {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 296,\n        columnNumber: 17\n      }\n    })),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 292,\n      columnNumber: 13\n    }\n  }), __jsx(ProtectedRoute, {\n    path: \"/s/payments/onboarding\",\n    isLoggedIn: isLoggedIn(),\n    render: props => __jsx(PaymentsOnboarding, _extends({}, props, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 312,\n        columnNumber: 32\n      }\n    })),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 309,\n      columnNumber: 13\n    }\n  }), __jsx(ProtectedRoute, {\n    path: \"/s/payments\",\n    isLoggedIn: isLoggedIn(),\n    render: props => __jsx(Payments, _extends({}, props, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 317,\n        columnNumber: 32\n      }\n    })),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 314,\n      columnNumber: 13\n    }\n  }), __jsx(ProtectedRoute, {\n    exact: true,\n    path: \"/s/marketing\",\n    isLoggedIn: isLoggedIn(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 319,\n      columnNumber: 13\n    }\n  }, __jsx(Redirect, {\n    to: \"/s/marketing/dashboard\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 320,\n      columnNumber: 15\n    }\n  })), __jsx(ProtectedRoute, {\n    exact: true,\n    path: \"/s/marketing/campaigns/new/:type\",\n    isLoggedIn: isLoggedIn(),\n    render: props => __jsx(CreateCampaign, _extends({}, props, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 326,\n        columnNumber: 32\n      }\n    })),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 322,\n      columnNumber: 13\n    }\n  }), __jsx(ProtectedRoute, {\n    exact: true,\n    path: \"/s/marketing/campaigns/:id\",\n    isLoggedIn: isLoggedIn(),\n    render: props => __jsx(ViewCampaign, _extends({}, props, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 332,\n        columnNumber: 32\n      }\n    })),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 328,\n      columnNumber: 13\n    }\n  }), __jsx(ProtectedRoute, {\n    exact: true,\n    path: \"/s/marketing/campaigns/:id/analytics\",\n    isLoggedIn: isLoggedIn(),\n    render: props => __jsx(CampaignAnalytics, _extends({}, props, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 338,\n        columnNumber: 32\n      }\n    })),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 334,\n      columnNumber: 13\n    }\n  }), __jsx(ProtectedRoute, {\n    exact: true,\n    path: \"/s/marketing/coupons/new\",\n    isLoggedIn: isLoggedIn(),\n    render: () => __jsx(CreateCoupon, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 344,\n        columnNumber: 29\n      }\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 340,\n      columnNumber: 13\n    }\n  }), __jsx(ProtectedRoute, {\n    exact: true,\n    path: \"/s/marketing/coupons/:id\",\n    isLoggedIn: isLoggedIn(),\n    render: () => __jsx(ViewCoupon, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 350,\n        columnNumber: 29\n      }\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 346,\n      columnNumber: 13\n    }\n  }), __jsx(ProtectedRoute, {\n    path: \"/s/marketing\",\n    isLoggedIn: isLoggedIn(),\n    render: () => __jsx(MarketingUI, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 355,\n        columnNumber: 29\n      }\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 352,\n      columnNumber: 13\n    }\n  }), __jsx(Route, {\n    exact: true,\n    path: \"/s/inbox/settings\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 357,\n      columnNumber: 13\n    }\n  }, __jsx(Redirect, {\n    to: \"/s/inbox/settings/channels\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 358,\n      columnNumber: 15\n    }\n  })), __jsx(ProtectedRoute, {\n    path: \"/s/inbox/settings\",\n    isLoggedIn: isLoggedIn(),\n    render: () => __jsx(InboxSettings, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 363,\n        columnNumber: 29\n      }\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 360,\n      columnNumber: 13\n    }\n  }), __jsx(ProtectedRoute, {\n    exact: true,\n    path: \"/s/inbox\",\n    isLoggedIn: isLoggedIn(),\n    render: () => __jsx(InboxProvider, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 376,\n        columnNumber: 17\n      }\n    }, __jsx(InboxComponent, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 377,\n        columnNumber: 19\n      }\n    })),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 371,\n      columnNumber: 13\n    }\n  }), __jsx(ProtectedRoute, {\n    path: \"/s/integrations\",\n    isLoggedIn: isLoggedIn() // @ts-ignore\n    ,\n    render: props => __jsx(Integrations, _extends({}, props, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 385,\n        columnNumber: 32\n      }\n    })),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 381,\n      columnNumber: 13\n    }\n  }), __jsx(ProtectedRoute, {\n    path: \"/s/settings\",\n    isLoggedIn: isLoggedIn(),\n    render: props => __jsx(SettingsContainer, _extends({}, _objectSpread(_objectSpread({}, props), {}, {\n      handleLogout,\n      reloadOrganization\n    }), {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 391,\n        columnNumber: 17\n      }\n    })),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 387,\n      columnNumber: 13\n    }\n  }), __jsx(ProtectedRoute, {\n    path: \"/s/developers\",\n    isLoggedIn: isLoggedIn(),\n    render: props => __jsx(DevelopersHomeUi, _extends({}, _objectSpread({}, props), {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 397,\n        columnNumber: 32\n      }\n    })),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 394,\n      columnNumber: 13\n    }\n  }), __jsx(Route, {\n    component: ErrorPage,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 399,\n      columnNumber: 13\n    }\n  })), __jsx(NoSubscriptionDialog, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 401,\n      columnNumber: 11\n    }\n  }))));\n}\n\nexport default connector(App);","map":{"version":3,"sources":["/Users/okechukwuiheagwara/Documents/Adewale/simpu/razzle/with-typescript/src/app/authenticated-app/index.tsx"],"names":["useToast","fromUnixTime","isAfter","jwt_decode","isEmpty","React","useQuery","connect","useSelector","Redirect","Route","Switch","loadState","toFormData","initializePusher","ErrorBoundary","ErrorPage","PreloadedStateProvider","ProtectedRoute","SimpuDashboard","ToastBox","NoSubscriptionDialog","authLoading","fetchProfile","logout","logUserOut","getUserChannels","openNoSubscriptionModal","Home","InboxComponent","selectOrgInboxStatusCount","stopPopSound","subscribeToWebsocket","InboxProvider","useReactQuerySubscription","InboxSettings","Integrations","generateRandomListColor","generateRandomListIcon","Lists","ListView","MarketingUI","CampaignAnalytics","CreateCampaign","filterCampaigns","ViewCampaign","CreateCoupon","ViewCoupon","Onboarding","Payments","PaymentsOnboarding","popSound","SettingsContainer","DevelopersHomeUi","addTable","addTableFromTemplate","importRowsCSV","importRowsMapping","connector","state","user","auth","token","organizations","teams","tables","profile","importedData","createTableModalIsOpen","globals","noSubscriptionModalIsOpen","shouldPopSound","inbox","inboxUi","websocketSubscribedOrgs","App","props","history","data","campaigns","page","query","undefined","channels","onboarding_task_info","length","lists","lists_by_id","isLoggedIn","decoded","exp","Date","toast","audioRef","useRef","unReadThreadCount","organisation_id","user_id","id","useEffect","forEach","profile_id","document","title","current","play","error","handleLogout","push","handleImport","payload","file","rest","position","render","handleImportMapping","onClose","handleImportNewTable","properties","mapping","table","columns","name","color","icon","table_id","reloadOrganization","org_id","e","window","location","reload","display","is_smart_list","addList","addListFromTemplate"],"mappings":"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","sourcesContent":["import { useToast } from '@chakra-ui/core';\nimport { fromUnixTime, isAfter } from 'date-fns';\nimport jwt_decode, { JwtPayload } from 'jwt-decode';\nimport { isEmpty } from 'lodash';\nimport * as React from 'react';\nimport { useQuery } from 'react-query';\nimport { connect, ConnectedProps, useSelector } from 'react-redux';\nimport { Redirect, Route, RouteComponentProps, Switch } from 'react-router-dom';\nimport { OptionTypeBase } from 'react-select';\nimport { RootState } from '../../root/';\nimport { loadState, toFormData } from '../../utils';\nimport { initializePusher } from '../../utils/pusher';\nimport {\n  ErrorBoundary,\n  ErrorPage,\n  PreloadedStateProvider,\n  ProtectedRoute,\n  SimpuDashboard,\n  ToastBox,\n} from '../components';\nimport { NoSubscriptionDialog } from '../components/NoSubscriptionDialog';\nimport {\n  authLoading,\n  fetchProfile,\n  logout,\n  logUserOut,\n  OnboardingTasksInfo,\n} from '../unauthenticated-app/authentication';\nimport { getUserChannels } from './channels';\nimport { openNoSubscriptionModal } from './globals';\nimport { Home } from './home';\nimport {\n  InboxComponent,\n  selectOrgInboxStatusCount,\n  stopPopSound,\n  subscribeToWebsocket,\n} from './inbox';\nimport { InboxProvider } from './inbox/components/Provider';\nimport { useReactQuerySubscription } from './inbox/inbox.hooks';\nimport { InboxSettings } from './inbox/settings';\nimport { Integrations } from './integrations';\nimport { generateRandomListColor, generateRandomListIcon, Lists, ListView } from './lists';\nimport { MarketingUI } from './marketing';\nimport {\n  CampaignAnalytics,\n  CreateCampaign,\n  filterCampaigns,\n  ViewCampaign,\n} from './marketing/campaigns';\nimport { CreateCoupon, ViewCoupon } from './marketing/coupons/components';\nimport { Onboarding } from './onboarding';\nimport { Payments, PaymentsOnboarding } from './payments';\n// @ts-ignore\nimport popSound from './pop_sound.mp3';\nimport { SettingsContainer } from './settings';\nimport { DevelopersHomeUi } from './settings/component/developers';\nimport {\n  addTable,\n  addTableFromTemplate,\n  importRowsCSV,\n  importRowsMapping,\n  ImportRowsMappingOptions,\n  ImportRowsOptions,\n  TablePropertiesOptions,\n} from './tables';\nimport { PropertySchema } from './tables/components';\n\nconst connector = connect(\n  (state: RootState) => ({\n    user: state.auth.user,\n    token: state.auth.token,\n    organizations: state.teams.organizations,\n    state,\n    tables: state.tables.tables,\n    profile: state.auth.profile,\n    importedData: state.tables.importedData,\n    createTableModalIsOpen: state.globals.createTableModalIsOpen,\n    noSubscriptionModalIsOpen: state.globals.noSubscriptionModalIsOpen,\n    shouldPopSound: state.inbox.inboxUi.shouldPopSound,\n    websocketSubscribedOrgs: state.inbox.inboxUi.websocketSubscribedOrgs,\n  }),\n  {\n    authLoading,\n    fetchProfile,\n    addTable,\n    logUserOut,\n    importRowsCSV,\n    importRowsMapping,\n    addTableFromTemplate,\n    openNoSubscriptionModal,\n    stopPopSound,\n    subscribeToWebsocket,\n  },\n);\n\ntype PropsFromRedux = ConnectedProps<typeof connector>;\ntype Props = RouteComponentProps & PropsFromRedux;\n\nfunction App(props: Props) {\n  const {\n    user,\n    tables,\n    history,\n    profile,\n    token,\n    organizations,\n    addTable,\n    logUserOut,\n    importedData,\n    importRowsCSV,\n    importRowsMapping,\n    addTableFromTemplate,\n    shouldPopSound,\n    stopPopSound,\n    subscribeToWebsocket,\n    websocketSubscribedOrgs,\n    authLoading,\n    fetchProfile,\n  } = props;\n\n  const { data: campaigns } = useQuery('campaigns', () =>\n    filterCampaigns({ page: 1, query: undefined }),\n  );\n\n  const { data: channels } = useQuery('channels', getUserChannels);\n\n  const onboarding_task_info: OnboardingTasksInfo = {\n    channels: !!channels?.length,\n    teams: !!props.state.teams.teams.length,\n    lists: !!props.state.lists.lists_by_id.length,\n    campaigns: !!campaigns?.data?.campaigns.length,\n  };\n\n  const isLoggedIn = () => {\n    if (token && !isEmpty(user)) {\n      const decoded = jwt_decode<JwtPayload>(token);\n      if (decoded && decoded.exp && isAfter(fromUnixTime(decoded.exp), new Date())) {\n        return true;\n      }\n    }\n    return false;\n  };\n\n  const toast = useToast();\n  const audioRef = React.useRef<HTMLAudioElement>(null);\n\n  const unReadThreadCount = useSelector((state: RootState) =>\n    selectOrgInboxStatusCount(state, {\n      organisation_id: profile?.organisation_id,\n      user_id: user?.id,\n    }),\n  );\n\n  React.useEffect(() => {\n    initializePusher(user?.id);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  React.useEffect(() => {\n    organizations.forEach(({ id }) => {\n      if (id && profile?.id && !websocketSubscribedOrgs[id]) {\n        subscribeToWebsocket({\n          organisation_id: id,\n          profile_id: profile?.id,\n        });\n      }\n    });\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [organizations, profile?.id, websocketSubscribedOrgs]);\n\n  React.useEffect(() => {\n    document.title = unReadThreadCount > 0 ? `(${unReadThreadCount}) Simpu` : 'Simpu';\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [unReadThreadCount]);\n\n  React.useEffect(() => {\n    try {\n      if (audioRef && audioRef.current && shouldPopSound) {\n        audioRef.current.play();\n        stopPopSound();\n      }\n    } catch (error) {}\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [shouldPopSound]);\n\n  useReactQuerySubscription();\n\n  async function handleLogout() {\n    await logout(user?.id);\n    logUserOut();\n    history.push('/login');\n  }\n\n  async function handleImport(payload: ImportRowsOptions) {\n    let { file, ...rest } = payload;\n    try {\n      await importRowsCSV(toFormData(rest, file, 'file'));\n      toast({\n        position: 'bottom-left',\n        render: () => <ToastBox status=\"success\" message=\"File upload successful\" />,\n      });\n    } catch (error) {\n      toast({\n        position: 'bottom-left',\n        render: () => <ToastBox message={error} />,\n      });\n    }\n  }\n\n  async function handleImportMapping(payload: ImportRowsMappingOptions) {\n    try {\n      await importRowsMapping(payload);\n    } catch (error) {\n      toast({\n        position: 'bottom-left',\n        render: ({ onClose }) => <ToastBox onClose={onClose} message={error} />,\n      });\n    }\n  }\n\n  async function handleImportNewTable(properties: PropertySchema[]) {\n    let mapping = {} as OptionTypeBase;\n    const { table }: { table: TablePropertiesOptions } = await addTable({\n      user_id: user?.id,\n      columns: properties,\n      name: 'Untitled',\n      color: generateRandomListColor(),\n      icon: generateRandomListIcon(),\n    });\n    table.columns.forEach(({ id }) => {\n      if (id) {\n        mapping[id] = id;\n      }\n    });\n    await handleImportMapping({\n      mapping,\n      table_id: table.id,\n      id: importedData.id,\n    });\n    return table;\n  }\n\n  async function reloadOrganization(org_id: string) {\n    if (!!loadState()) {\n      authLoading(true);\n      try {\n        await fetchProfile(org_id);\n      } catch (e) {}\n      window.location.reload();\n    }\n  }\n\n  return (\n    <PreloadedStateProvider>\n      <SimpuDashboard\n        onboarding_task_info={onboarding_task_info}\n        tables={tables}\n        organizations={organizations}\n        profile={profile}\n        user={user}\n        onLogout={handleLogout}\n        unReadThreadCount={unReadThreadCount}\n      >\n        <audio controls ref={audioRef} style={{ display: 'none' }}>\n          <source src={popSound} />\n          Your browser does not support the audio element.\n        </audio>\n        <ErrorBoundary>\n          <Switch>\n            <ProtectedRoute\n              path=\"/s/home\"\n              isLoggedIn={isLoggedIn()}\n              render={props => <Home {...props} />}\n            />\n            <ProtectedRoute\n              path=\"/s/onboarding\"\n              isLoggedIn={isLoggedIn()}\n              render={props => <Onboarding {...{ user, profile, ...props }} />}\n            />\n            <ProtectedRoute\n              exact\n              path=\"/s/lists/view/:id/smart\"\n              isLoggedIn={isLoggedIn()}\n              render={props => <ListView {...{ ...props, is_smart_list: true }} />}\n            />\n            <ProtectedRoute\n              exact\n              path=\"/s/lists/view/:id\"\n              isLoggedIn={isLoggedIn()}\n              render={props => <ListView {...{ ...props, is_smart_list: false }} />}\n            />\n            <ProtectedRoute\n              path=\"/s/lists\"\n              isLoggedIn={isLoggedIn()}\n              render={props => (\n                <Lists\n                  {...{\n                    ...props,\n                    addList: addTable,\n                    addListFromTemplate: addTableFromTemplate,\n                    handleImport,\n                    handleImportMapping,\n                    handleImportNewTable,\n                    importedData,\n                  }}\n                />\n              )}\n            />\n            <ProtectedRoute\n              path=\"/s/payments/onboarding\"\n              isLoggedIn={isLoggedIn()}\n              render={props => <PaymentsOnboarding {...props} />}\n            />\n            <ProtectedRoute\n              path=\"/s/payments\"\n              isLoggedIn={isLoggedIn()}\n              render={props => <Payments {...props} />}\n            />\n            <ProtectedRoute exact path=\"/s/marketing\" isLoggedIn={isLoggedIn()}>\n              <Redirect to=\"/s/marketing/dashboard\" />\n            </ProtectedRoute>\n            <ProtectedRoute\n              exact\n              path=\"/s/marketing/campaigns/new/:type\"\n              isLoggedIn={isLoggedIn()}\n              render={props => <CreateCampaign {...props} />}\n            />\n            <ProtectedRoute\n              exact\n              path=\"/s/marketing/campaigns/:id\"\n              isLoggedIn={isLoggedIn()}\n              render={props => <ViewCampaign {...props} />}\n            />\n            <ProtectedRoute\n              exact\n              path=\"/s/marketing/campaigns/:id/analytics\"\n              isLoggedIn={isLoggedIn()}\n              render={props => <CampaignAnalytics {...props} />}\n            />\n            <ProtectedRoute\n              exact\n              path=\"/s/marketing/coupons/new\"\n              isLoggedIn={isLoggedIn()}\n              render={() => <CreateCoupon />}\n            />\n            <ProtectedRoute\n              exact\n              path=\"/s/marketing/coupons/:id\"\n              isLoggedIn={isLoggedIn()}\n              render={() => <ViewCoupon />}\n            />\n            <ProtectedRoute\n              path=\"/s/marketing\"\n              isLoggedIn={isLoggedIn()}\n              render={() => <MarketingUI />}\n            />\n            <Route exact path=\"/s/inbox/settings\">\n              <Redirect to=\"/s/inbox/settings/channels\" />\n            </Route>\n            <ProtectedRoute\n              path=\"/s/inbox/settings\"\n              isLoggedIn={isLoggedIn()}\n              render={() => <InboxSettings />}\n            />\n            {/* <ProtectedRoute\n              path=\"/s/inbox/:id\"\n              isLoggedIn={isLoggedIn()}\n              // @ts-ignore\n              render={props => <InboxComponent {...props} />}\n            /> */}\n            <ProtectedRoute\n              exact\n              path=\"/s/inbox\"\n              isLoggedIn={isLoggedIn()}\n              render={() => (\n                <InboxProvider>\n                  <InboxComponent />\n                </InboxProvider>\n              )}\n            />\n            <ProtectedRoute\n              path=\"/s/integrations\"\n              isLoggedIn={isLoggedIn()}\n              // @ts-ignore\n              render={props => <Integrations {...props} />}\n            />\n            <ProtectedRoute\n              path=\"/s/settings\"\n              isLoggedIn={isLoggedIn()}\n              render={props => (\n                <SettingsContainer {...{ ...props, handleLogout, reloadOrganization }} />\n              )}\n            />\n            <ProtectedRoute\n              path=\"/s/developers\"\n              isLoggedIn={isLoggedIn()}\n              render={props => <DevelopersHomeUi {...{ ...props }} />}\n            />\n            <Route component={ErrorPage} />\n          </Switch>\n          <NoSubscriptionDialog />\n        </ErrorBoundary>\n      </SimpuDashboard>\n    </PreloadedStateProvider>\n  );\n}\n\nexport default connector(App);\n"]},"metadata":{},"sourceType":"module"}